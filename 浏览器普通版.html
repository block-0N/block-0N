<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç®€çº¦å¤§æ°”å¯¼èˆªä¸»é¡µ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        .fa {
            display: inline-block;
            font-family: Arial, sans-serif;
            font-weight: normal;
            font-style: normal;
            text-align: center;
            font-size: 1.1em;
            line-height: 1;
            width: 1.2em;
        }
        
        .fa-calendar-plus-o:before { content: "ğŸ“…"; }
        .fa-birthday-cake:before { content: "ğŸ‚"; }
        .fa-plus-circle:before { content: "â•"; }
        .fa-search:before { content: "ğŸ”"; }
        .fa-hourglass:before { content: "âŒ›"; }
        .fa-calculator:before { content: "ğŸ§®"; }
        .fa-exchange:before { content: "ğŸ”„"; }
        .fa-moon-o:before { content: "ğŸŒ™"; }
        .fa-sun-o:before { content: "â˜€ï¸"; }
        .fa-times:before { content: "âŒ"; } 
        .fa-users:before { content: "ğŸ“"; }

        .dark-mode {
            --bg-primary: #1e293b;
            --bg-secondary: #0f172a;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --card-bg: #334155;
            --card-hover: #475569;
            --border-color: #475569;
            --primary-color: #3b82f6;
            --accent-color: #a78bfa;
        }
        
        .light-mode {
            --bg-primary: #f5f7fa;
            --bg-secondary: #ffffff;
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --card-bg: #ffffff;
            --card-hover: #f8fafc;
            --border-color: #e2e8f0;
            --primary-color: #2563eb;
            --accent-color: #8b5cf6;
        }
        
        .note-item {
            padding: 0.75rem;
            border-radius: 0.5rem;
            background-color: #f8fafc;
            border: 1px solid #e2e8f0;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .note-item:hover {
            background-color: #f1f5f9;
            border-color: #cbd5e1;
        }

        body {
            transition: all 0.3s ease;
        }
    </style>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#2563eb',
                        secondary: '#475569',
                        accent: '#8b5cf6',
                        dark: '#0f172a',
                        light: '#f1f5f9'
                    },
                    fontFamily: {
                        inter: ['Inter', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>

    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto { content-visibility: auto; }
            .text-glow { text-shadow: 0 0 15px rgba(37, 99, 235, 0.2); }
            .card-hover { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
            .card-hover:hover {
                transform: translateY(-4px) scale(1.02);
                box-shadow: 0 12px 24px -8px rgba(0, 0, 0, 0.15);
            }
            .bg-dynamic {
                background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
                background-size: 400% 400%;
                animation: gradient 15s ease infinite;
            }
            @keyframes gradient {
                0% { background-position: 0% 50%; }
                50% { background-position: 100% 50%; }
                100% { background-position: 0% 50%; }
            }
            .search-focus { @apply border-primary ring-2 ring-primary/20; }
            .festival-tag { @apply px-3 py-1 rounded-full text-sm font-medium bg-red-100 text-red-600; }
            .reminder-tag { @apply px-3 py-1 rounded-full text-sm font-medium bg-pink-100 text-pink-600 animate-pulse; }
            .countdown-tag { @apply px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-600; }
            
            .nav-card {
                @apply flex flex-col items-center justify-center rounded-2xl card-hover shadow-md w-24 h-24 p-3 relative;
                background-color: var(--card-bg) !important;
                color: var(--text-primary) !important;
                border-color: var(--border-color) !important;
            }
            .nav-card:hover { background-color: var(--card-hover) !important; }
            
            .nav-icon-wrapper {
                @apply w-10 h-10 rounded-full flex items-center justify-center mb-1;
            }
            
            .calc-btn {
                @apply w-full h-12 rounded-lg flex items-center justify-center text-lg font-medium transition-all hover:bg-primary/10;
                color: var(--text-primary) !important;
                background-color: var(--card-bg) !important;
                border-color: var(--border-color) !important;
            }
            .calc-btn-number {
                background-color: var(--card-bg) !important;
                color: var(--text-primary) !important;
            }
            .calc-btn-operator { color: var(--primary-color) !important; }
            .calc-btn-action { color: var(--accent-color) !important; }
            
            .calc-display-wrapper {
                @apply w-full rounded-lg border p-3 mb-4;
                background-color: var(--card-bg) !important;
                border-color: var(--border-color) !important;
            }
            .calc-process {
                @apply text-left text-base h-8 leading-8;
                color: var(--text-secondary) !important;
            }
            .calc-result {
                @apply text-right text-xl font-medium h-8 leading-8;
                color: var(--primary-color) !important;
            }
            
            .swap-btn {
                @apply w-8 h-8 rounded-full flex items-center justify-center cursor-pointer transition-all hover:bg-primary/20;
                color: var(--primary-color) !important;
                background-color: var(--card-bg) !important;
            }
            
            .dark-mode .festival-tag { 
                background-color: #472e32 !important;
                color: #fca5a5 !important;
            }
            .dark-mode .reminder-tag { 
                background-color: #573a46 !important;
                color: #f9a8d4 !important;
            }
            .dark-mode .countdown-tag { 
                background-color: #273b54 !important;
                color: #93c5fd !important;
            }
            
            /* åˆ é™¤æŒ‰é’®æ ·å¼ */
            .delete-btn {
                @apply absolute top-1 right-1 w-6 h-6 rounded-full flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity bg-red-100/80 hover:bg-red-200 text-red-600 cursor-pointer z-10;
            }
            .dark-mode .delete-btn {
                @apply bg-red-900/80 hover:bg-red-800 text-red-300;
            }
            .nav-card:hover .delete-btn {
                opacity: 1;
            }
            
            /* emojiå›¾æ ‡æ ·å¼ */
            .emoji-icon {
                @apply w-6 h-6 flex items-center justify-center text-xl;
            }
        }
    </style>
</head>
<body class="bg-dynamic min-h-screen flex flex-col items-center justify-center p-4 font-inter light-mode">
    <div class="w-full max-w-5xl mx-auto mb-6 flex justify-end gap-3 flex-wrap">
        <button id="add-custom-date-btn" class="px-4 py-2 rounded-lg bg-white/80 backdrop-blur-sm shadow-md hover:shadow-lg transition-shadow flex items-center gap-2">
            <i class="fa fa-calendar-plus-o text-primary"></i>
            <span class="text-sm font-medium">è‡ªå®šä¹‰æ—¥æœŸ</span>
        </button>
        <button id="add-birthday-btn" class="px-4 py-2 rounded-lg bg-white/80 backdrop-blur-sm shadow-md hover:shadow-lg transition-shadow flex items-center gap-2">
            <i class="fa fa-birthday-cake text-pink-500"></i>
            <span class="text-sm font-medium">æ·»åŠ ç”Ÿæ—¥</span>
        </button>
        <button id="add-countdown-btn" class="px-4 py-2 rounded-lg bg-white/80 backdrop-blur-sm shadow-md hover:shadow-lg transition-shadow flex items-center gap-2">
            <i class="fa fa-hourglass text-blue-500"></i>
            <span class="text-sm font-medium">æ·»åŠ å€’è®¡æ—¶</span>
        </button>
        <button id="theme-toggle" class="px-4 py-2 rounded-lg bg-white/80 backdrop-blur-sm shadow-md hover:shadow-lg transition-shadow flex items-center gap-2">
            <i class="fa fa-moon-o text-slate-600"></i>
            <span id="theme-text" class="text-sm font-medium">æ·±è‰²æ¨¡å¼</span>
        </button>
        <button id="version-toggle" class="px-4 py-2 rounded-lg bg-white/80 backdrop-blur-sm shadow-md hover:shadow-lg transition-shadow flex items-center gap-2">
            <i class="fa fa-exchange text-slate-600"></i>
            <a href="æµè§ˆå™¨ç®€çº¦ç‰ˆ.html">åˆ‡æ¢è‡³ç®€çº¦ç‰ˆ</a>
        </button>

    </div>

    <div class="w-full max-w-5xl mx-auto flex flex-col items-center">
        <div id="greeting" class="text-secondary text-lg md:text-xl mb-4 text-center"></div>
        
        <div class="mb-6 text-center bg-white/80 backdrop-blur-sm rounded-2xl p-6 md:p-8 shadow-lg">
            <div id="digital-clock" class="text-[clamp(3.5rem,10vw,7rem)] font-bold text-dark text-glow mb-3"></div>
            <div id="date-info" class="text-[clamp(1rem,2vw,1.3rem)] text-secondary flex flex-wrap justify-center gap-x-4 gap-y-2 mb-3">
                <span id="week-day" class="px-2 py-1 bg-primary/10 rounded-full"></span>
                <span id="gregorian-date" class="px-2 py-1 bg-secondary/10 rounded-full"></span>
                <span id="lunar-date" class="px-2 py-1 bg-accent/10 text-accent rounded-full"></span>
            </div>
            <div id="countdown-display" class="countdown-tag mb-3 hidden"></div>
            <div id="festival-info" class="festival-tag"></div>
        </div>

        <div class="w-full max-w-2xl mb-8 relative">
            <input type="text" id="search-input" placeholder="è¾“å…¥æœç´¢å†…å®¹" 
                class="w-full py-4 px-6 pr-20 rounded-full border border-slate-200 focus:search-focus outline-none transition-all bg-white/90 shadow-md">
            <select id="search-engine" class="absolute right-16 top-1/2 -translate-y-1/2 bg-transparent border-0 text-secondary focus:outline-none text-sm">
                <option value="baidu">ç™¾åº¦</option>
                <option value="google">è°·æ­Œ</option>
                <option value="bing">å¿…åº”</option>
            </select>
            <button id="search-btn" class="absolute right-3 top-1/2 -translate-y-1/2 text-secondary hover:text-primary transition-colors p-1 rounded-full hover:bg-primary/10">
                <i class="fa fa-search text-xl"></i>
            </button>
        </div>

        <div class="w-full max-w-2xl mb-4 flex border-b border-slate-200">
            <button id="tab-converter" class="px-6 py-2 text-primary border-b-2 border-primary font-medium">å•ä½æ¢ç®—</button>
            <button id="tab-calculator" class="px-6 py-2 text-secondary hover:text-primary transition-colors">è®¡ç®—å™¨</button>
            <button id="tab-relative" class="px-6 py-2 text-secondary hover:text-primary transition-colors">å¤‡å¿˜å½•</button>
        </div>

        <div id="converter-panel" class="w-full max-w-2xl mb-8 bg-white/80 backdrop-blur-sm rounded-xl shadow-md p-5">
            <h3 class="font-medium text-dark text-lg mb-4 flex items-center gap-2">
                <i class="fa fa-exchange text-primary"></i> å•ä½æ¢ç®—
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-12 gap-4">
                <div class="md:col-span-5">
                    <select id="convert-type" class="w-full rounded-lg border border-slate-200 p-2 mb-2 text-sm">
                        <option value="length">é•¿åº¦</option>
                        <option value="weight">é‡é‡</option>
                        <option value="temp">æ¸©åº¦</option>
                        <option value="time">æ—¶é—´</option>
                        <option value="area">é¢ç§¯</option>
                    </select>
                    <div class="flex gap-2 mb-2">
                        <input type="number" id="input-value" placeholder="è¾“å…¥æ•°å€¼" class="flex-1 rounded-lg border border-slate-200 p-2 text-sm">
                        <select id="input-unit" class="rounded-lg border border-slate-200 p-2 text-sm">
                            <option value="meter">ç±³</option>
                            <option value="foot">è‹±å°º</option>
                            <option value="inch">è‹±å¯¸</option>
                        </select>
                    </div>
                </div>
                
                <div class="md:col-span-2 flex items-center justify-center">
                    <div id="swap-units" class="swap-btn">
                        <i class="fa fa-exchange"></i>
                    </div>
                </div>
                
                <div class="md:col-span-5 flex flex-col justify-center">
                    <div class="flex gap-2 mb-2">
                        <div id="convert-result" class="flex-1 text-lg font-medium text-primary rounded-lg border border-slate-200 p-2 text-sm">è¯·è¾“å…¥æ•°å€¼è¿›è¡Œæ¢ç®—</div>
                        <select id="output-unit" class="rounded-lg border border-slate-200 p-2 text-sm">
                            <option value="foot">è‹±å°º</option>
                            <option value="inch">è‹±å¯¸</option>
                            <option value="meter">ç±³</option>
                        </select>
                    </div>
                    <div class="text-xs text-secondary mt-1">æ”¯æŒåŒå‘æ¢ç®—ï¼Œç‚¹å‡»åˆ‡æ¢æŒ‰é’®å¯äº’æ¢å•ä½</div>
                </div>
            </div>
        </div>

        <!-- è®¡ç®—å™¨é¢æ¿ -->
        <div id="calculator-panel" class="w-full max-w-2xl mb-8 bg-white/80 backdrop-blur-sm rounded-xl shadow-md p-5 hidden">
            <h3 class="font-medium text-dark text-lg mb-4 flex items-center gap-2">
                <i class="fa fa-calculator text-primary"></i> è®¡ç®—å™¨
            </h3>
            <div class="calc-display-wrapper">
                <div id="calc-process" class="calc-process"></div>
                <div id="calc-result" class="calc-result"></div>
            </div>
            <div class="grid grid-cols-4 gap-2">
                <button class="calc-btn calc-btn-action" data-value="AC">AC</button>
                <button class="calc-btn calc-btn-action" data-value="DEL">DEL</button>
                <button class="calc-btn calc-btn-action" data-value="%">%</button>
                <button class="calc-btn calc-btn-operator" data-value="/">Ã·</button>
                
                <button class="calc-btn calc-btn-number" data-value="7">7</button>
                <button class="calc-btn calc-btn-number" data-value="8">8</button>
                <button class="calc-btn calc-btn-number" data-value="9">9</button>
                <button class="calc-btn calc-btn-operator" data-value="*">Ã—</button>
                
                <button class="calc-btn calc-btn-number" data-value="4">4</button>
                <button class="calc-btn calc-btn-number" data-value="5">5</button>
                <button class="calc-btn calc-btn-number" data-value="6">6</button>
                <button class="calc-btn calc-btn-operator" data-value="-">-</button>
                
                <button class="calc-btn calc-btn-number" data-value="1">1</button>
                <button class="calc-btn calc-btn-number" data-value="2">2</button>
                <button class="calc-btn calc-btn-number" data-value="3">3</button>
                <button class="calc-btn calc-btn-operator" data-value="+">+</button>
                
                <button class="calc-btn calc-btn-number" data-value="00">00</button>
                <button class="calc-btn calc-btn-number" data-value="0">0</button>
                <button class="calc-btn calc-btn-number" data-value=".">.</button>
                <button class="calc-btn calc-btn-operator bg-primary text-white" data-value="=">=</button>
            </div>
        </div>

        <!-- å¤‡å¿˜å½•é¢æ¿ -->
<div id="relative-panel" class="w-full max-w-2xl mb-8 bg-white/80 backdrop-blur-sm rounded-xl shadow-md p-5 hidden">
    <h3 class="font-medium text-dark text-lg mb-4 flex items-center gap-2">
        <i class="fa fa-users text-primary"></i> å¤‡å¿˜å½•
    </h3>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- å¤‡å¿˜å½•è¾“å…¥ -->
                <div>
                    <label class="block text-sm font-medium text-secondary mb-2">æ–°å»º/ç¼–è¾‘å¤‡å¿˜å½•</label>
                    <input type="text" id="note-title" class="w-full rounded-lg border border-slate-200 p-3 mb-4 text-sm" placeholder="è¾“å…¥æ ‡é¢˜">
                    <textarea id="note-content" class="w-full rounded-lg border border-slate-200 p-3 mb-4 text-sm min-h-[120px]" placeholder="è¾“å…¥å†…å®¹"></textarea>
                    <div class="flex gap-3">
                        <button id="save-note" class="flex-1 bg-primary text-white rounded-lg p-3 text-sm hover:bg-primary/90 transition">ä¿å­˜</button>
                        <button id="clear-note" class="flex-1 bg-slate-200 text-dark rounded-lg p-3 text-sm hover:bg-slate-300 transition">æ¸…ç©º</button>
                    </div>
                    <input type="hidden" id="current-note-id">
                </div>

                <!-- å¤‡å¿˜å½•åˆ—è¡¨ -->
                <div>
                    <div class="flex justify-between items-center mb-2">
                        <label class="block text-sm font-medium text-secondary">æˆ‘çš„å¤‡å¿˜å½•</label>
                        <button id="delete-all-notes" class="text-sm text-red-500 hover:text-red-600 transition">æ¸…ç©ºæ‰€æœ‰</button>
                    </div>
                    <div id="notes-list" class="max-h-[280px] overflow-y-auto space-y-3 border border-slate-100 rounded-lg p-3">
                        <div class="text-center text-slate-400 text-sm py-8" id="empty-tip">æš‚æ— å¤‡å¿˜å½•ï¼Œç‚¹å‡»å·¦ä¾§æ·»åŠ </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="shortcut-nav" class="w-full max-w-2xl flex flex-wrap gap-4 justify-start">
            
            <!-- è‡ªå®šä¹‰ç«™ç‚¹å®¹å™¨ -->
            <div id="custom-sites-container" class="flex flex-wrap gap-4"></div>
            
            <!-- æ·»åŠ ç½‘ç«™æŒ‰é’® -->
            <button id="add-site-btn" class="nav-card border-2 border-dashed border-slate-200 hover:border-primary">
                <div class="nav-icon-wrapper bg-slate-100">
                    <i class="fa fa-plus-circle text-slate-400 hover:text-primary text-lg transition-colors"></i>
                </div>
                <span class="text-xs font-medium text-slate-500 hover:text-primary transition-colors">æ·»åŠ ç½‘ç«™</span>
            </button>
        </div>
    </div>

    <script>
        // ç½‘ç«™ç±»å‹å’Œå¯¹åº”emojié…ç½®
        const SITE_TYPES = [
            { id: 1, name: 'æ¸¸æˆå¨±ä¹', emoji: 'ğŸ®' },
            { id: 2, name: 'åŠå…¬å­¦ä¹ ', emoji: 'ğŸ“š' },
            { id: 3, name: 'è´­ç‰©æ¶ˆè´¹', emoji: 'ğŸ›’' },
            { id: 4, name: 'å·¥å…·æœåŠ¡', emoji: 'ğŸ”§' },
            { id: 5, name: 'æ–°é—»èµ„è®¯', emoji: 'ğŸ“°' },
            { id: 6, name: 'è§†é¢‘å½±éŸ³', emoji: 'ğŸ¬' },
            { id: 7, name: 'äº¤é€šå’¨è¯¢', emoji: 'ğŸšŒ' },
            { id: 8, name: 'ç¤¾äº¤å¯¹è¯', emoji: 'ğŸ“±' },
            { id: 9, name: 'éŸ³ä¹éŸ³é¢‘', emoji: 'ğŸµ' },
            { id: 10, name: 'å…¶ä»–ç±»å‹', emoji: 'ğŸ”—' }
        ];
        // 2024-2040å¹´äºŒåå››èŠ‚æ°”æ•°æ®
const SOLAR_TERMS = {
  2026: {
    "1-5": "å°å¯’", "1-20": "å¤§å¯’", "2-4": "ç«‹æ˜¥", "2-18": "é›¨æ°´",
    "3-5": "æƒŠè›°", "3-20": "æ˜¥åˆ†", "4-5": "æ¸…æ˜", "4-20": "è°·é›¨",
    "5-5": "ç«‹å¤", "5-21": "å°æ»¡", "6-5": "èŠ’ç§", "6-21": "å¤è‡³",
    "7-7": "å°æš‘", "7-23": "å¤§æš‘", "8-7": "ç«‹ç§‹", "8-23": "å¤„æš‘",
    "9-7": "ç™½éœ²", "9-23": "ç§‹åˆ†", "10-8": "å¯’éœ²", "10-23": "éœœé™",
    "11-7": "ç«‹å†¬", "11-22": "å°é›ª", "12-7": "å¤§é›ª", "12-21": "å†¬è‡³"
  },
  2027: {
    "1-5": "å°å¯’", "1-20": "å¤§å¯’", "2-4": "ç«‹æ˜¥", "2-19": "é›¨æ°´",
    "3-6": "æƒŠè›°", "3-21": "æ˜¥åˆ†", "4-5": "æ¸…æ˜", "4-20": "è°·é›¨",
    "5-6": "ç«‹å¤", "5-21": "å°æ»¡", "6-6": "èŠ’ç§", "6-21": "å¤è‡³",
    "7-7": "å°æš‘", "7-23": "å¤§æš‘", "8-8": "ç«‹ç§‹", "8-23": "å¤„æš‘",
    "9-8": "ç™½éœ²", "9-23": "ç§‹åˆ†", "10-8": "å¯’éœ²", "10-23": "éœœé™",
    "11-7": "ç«‹å†¬", "11-22": "å°é›ª", "12-7": "å¤§é›ª", "12-22": "å†¬è‡³"
  },
  2028: {
    "1-6": "å°å¯’", "1-20": "å¤§å¯’", "2-4": "ç«‹æ˜¥", "2-18": "é›¨æ°´",
    "3-5": "æƒŠè›°", "3-20": "æ˜¥åˆ†", "4-4": "æ¸…æ˜", "4-19": "è°·é›¨",
    "5-5": "ç«‹å¤", "5-20": "å°æ»¡", "6-5": "èŠ’ç§", "6-21": "å¤è‡³",
    "7-7": "å°æš‘", "7-22": "å¤§æš‘", "8-7": "ç«‹ç§‹", "8-23": "å¤„æš‘",
    "9-7": "ç™½éœ²", "9-22": "ç§‹åˆ†", "10-8": "å¯’éœ²", "10-23": "éœœé™",
    "11-7": "ç«‹å†¬", "11-22": "å°é›ª", "12-7": "å¤§é›ª", "12-21": "å†¬è‡³"
  },
  2029: {
    "1-5": "å°å¯’", "1-20": "å¤§å¯’", "2-3": "ç«‹æ˜¥", "2-18": "é›¨æ°´",
    "3-5": "æƒŠè›°", "3-20": "æ˜¥åˆ†", "4-4": "æ¸…æ˜", "4-20": "è°·é›¨",
    "5-5": "ç«‹å¤", "5-20": "å°æ»¡", "6-5": "èŠ’ç§", "6-21": "å¤è‡³",
    "7-7": "å°æš‘", "7-22": "å¤§æš‘", "8-7": "ç«‹ç§‹", "8-23": "å¤„æš‘",
    "9-7": "ç™½éœ²", "9-23": "ç§‹åˆ†", "10-8": "å¯’éœ²", "10-23": "éœœé™",
    "11-7": "ç«‹å†¬", "11-22": "å°é›ª", "12-7": "å¤§é›ª", "12-22": "å†¬è‡³"
  },
  2030: {
    "1-6": "å°å¯’", "1-20": "å¤§å¯’", "2-4": "ç«‹æ˜¥", "2-19": "é›¨æ°´",
    "3-6": "æƒŠè›°", "3-21": "æ˜¥åˆ†", "4-5": "æ¸…æ˜", "4-20": "è°·é›¨",
    "5-6": "ç«‹å¤", "5-21": "å°æ»¡", "6-6": "èŠ’ç§", "6-21": "å¤è‡³",
    "7-7": "å°æš‘", "7-23": "å¤§æš‘", "8-8": "ç«‹ç§‹", "8-24": "å¤„æš‘",
    "9-8": "ç™½éœ²", "9-23": "ç§‹åˆ†", "10-9": "å¯’éœ²", "10-24": "éœœé™",
    "11-8": "ç«‹å†¬", "11-23": "å°é›ª", "12-8": "å¤§é›ª", "12-22": "å†¬è‡³"
  },
  2031: {
    "1-5": "å°å¯’", "1-20": "å¤§å¯’", "2-4": "ç«‹æ˜¥", "2-18": "é›¨æ°´",
    "3-5": "æƒŠè›°", "3-20": "æ˜¥åˆ†", "4-4": "æ¸…æ˜", "4-20": "è°·é›¨",
    "5-5": "ç«‹å¤", "5-20": "å°æ»¡", "6-5": "èŠ’ç§", "6-21": "å¤è‡³",
    "7-7": "å°æš‘", "7-22": "å¤§æš‘", "8-7": "ç«‹ç§‹", "8-23": "å¤„æš‘",
    "9-7": "ç™½éœ²", "9-23": "ç§‹åˆ†", "10-8": "å¯’éœ²", "10-23": "éœœé™",
    "11-7": "ç«‹å†¬", "11-22": "å°é›ª", "12-7": "å¤§é›ª", "12-22": "å†¬è‡³"
  },
  2032: {
    "1-5": "å°å¯’", "1-19": "å¤§å¯’", "2-3": "ç«‹æ˜¥", "2-18": "é›¨æ°´",
    "3-5": "æƒŠè›°", "3-20": "æ˜¥åˆ†", "4-4": "æ¸…æ˜", "4-19": "è°·é›¨",
    "5-5": "ç«‹å¤", "5-20": "å°æ»¡", "6-5": "èŠ’ç§", "6-21": "å¤è‡³",
    "7-7": "å°æš‘", "7-22": "å¤§æš‘", "8-7": "ç«‹ç§‹", "8-22": "å¤„æš‘",
    "9-7": "ç™½éœ²", "9-22": "ç§‹åˆ†", "10-7": "å¯’éœ²", "10-23": "éœœé™",
    "11-7": "ç«‹å†¬", "11-22": "å°é›ª", "12-7": "å¤§é›ª", "12-21": "å†¬è‡³"
  },
  2033: {
    "1-5": "å°å¯’", "1-20": "å¤§å¯’", "2-4": "ç«‹æ˜¥", "2-19": "é›¨æ°´",
    "3-6": "æƒŠè›°", "3-21": "æ˜¥åˆ†", "4-5": "æ¸…æ˜", "4-20": "è°·é›¨",
    "5-6": "ç«‹å¤", "5-21": "å°æ»¡", "6-6": "èŠ’ç§", "6-21": "å¤è‡³",
    "7-8": "å°æš‘", "7-23": "å¤§æš‘", "8-8": "ç«‹ç§‹", "8-23": "å¤„æš‘",
    "9-8": "ç™½éœ²", "9-23": "ç§‹åˆ†", "10-8": "å¯’éœ²", "10-24": "éœœé™",
    "11-8": "ç«‹å†¬", "11-23": "å°é›ª", "12-8": "å¤§é›ª", "12-22": "å†¬è‡³"
  },
  2034: {
    "1-6": "å°å¯’", "1-20": "å¤§å¯’", "2-4": "ç«‹æ˜¥", "2-19": "é›¨æ°´",
    "3-6": "æƒŠè›°", "3-21": "æ˜¥åˆ†", "4-5": "æ¸…æ˜", "4-20": "è°·é›¨",
    "5-6": "ç«‹å¤", "5-21": "å°æ»¡", "6-6": "èŠ’ç§", "6-22": "å¤è‡³",
    "7-8": "å°æš‘", "7-23": "å¤§æš‘", "8-8": "ç«‹ç§‹", "8-24": "å¤„æš‘",
    "9-8": "ç™½éœ²", "9-24": "ç§‹åˆ†", "10-9": "å¯’éœ²", "10-24": "éœœé™",
    "11-8": "ç«‹å†¬", "11-23": "å°é›ª", "12-8": "å¤§é›ª", "12-22": "å†¬è‡³"
  },
  2035: {
    "1-5": "å°å¯’", "1-20": "å¤§å¯’", "2-3": "ç«‹æ˜¥", "2-18": "é›¨æ°´",
    "3-5": "æƒŠè›°", "3-20": "æ˜¥åˆ†", "4-4": "æ¸…æ˜", "4-20": "è°·é›¨",
    "5-5": "ç«‹å¤", "5-20": "å°æ»¡", "6-5": "èŠ’ç§", "6-21": "å¤è‡³",
    "7-7": "å°æš‘", "7-23": "å¤§æš‘", "8-8": "ç«‹ç§‹", "8-23": "å¤„æš‘",
    "9-8": "ç™½éœ²", "9-23": "ç§‹åˆ†", "10-8": "å¯’éœ²", "10-23": "éœœé™",
    "11-7": "ç«‹å†¬", "11-22": "å°é›ª", "12-7": "å¤§é›ª", "12-22": "å†¬è‡³"
  },
  2036: {
    "1-5": "å°å¯’", "1-19": "å¤§å¯’", "2-3": "ç«‹æ˜¥", "2-18": "é›¨æ°´",
    "3-5": "æƒŠè›°", "3-20": "æ˜¥åˆ†", "4-4": "æ¸…æ˜", "4-19": "è°·é›¨",
    "5-5": "ç«‹å¤", "5-20": "å°æ»¡", "6-5": "èŠ’ç§", "6-21": "å¤è‡³",
    "7-7": "å°æš‘", "7-22": "å¤§æš‘", "8-7": "ç«‹ç§‹", "8-22": "å¤„æš‘",
    "9-7": "ç™½éœ²", "9-22": "ç§‹åˆ†", "10-7": "å¯’éœ²", "10-22": "éœœé™",
    "11-6": "ç«‹å†¬", "11-21": "å°é›ª", "12-6": "å¤§é›ª", "12-21": "å†¬è‡³"
  },
  2037: {
    "1-5": "å°å¯’", "1-20": "å¤§å¯’", "2-4": "ç«‹æ˜¥", "2-19": "é›¨æ°´",
    "3-6": "æƒŠè›°", "3-21": "æ˜¥åˆ†", "4-5": "æ¸…æ˜", "4-20": "è°·é›¨",
    "5-6": "ç«‹å¤", "5-21": "å°æ»¡", "6-6": "èŠ’ç§", "6-21": "å¤è‡³",
    "7-7": "å°æš‘", "7-23": "å¤§æš‘", "8-8": "ç«‹ç§‹", "8-23": "å¤„æš‘",
    "9-8": "ç™½éœ²", "9-23": "ç§‹åˆ†", "10-8": "å¯’éœ²", "10-23": "éœœé™",
    "11-7": "ç«‹å†¬", "11-22": "å°é›ª", "12-7": "å¤§é›ª", "12-22": "å†¬è‡³"
  },
  2038: {
    "1-6": "å°å¯’", "1-20": "å¤§å¯’", "2-4": "ç«‹æ˜¥", "2-19": "é›¨æ°´",
    "3-6": "æƒŠè›°", "3-21": "æ˜¥åˆ†", "4-5": "æ¸…æ˜", "4-20": "è°·é›¨",
    "5-6": "ç«‹å¤", "5-21": "å°æ»¡", "6-6": "èŠ’ç§", "6-22": "å¤è‡³",
    "7-8": "å°æš‘", "7-23": "å¤§æš‘", "8-8": "ç«‹ç§‹", "8-24": "å¤„æš‘",
    "9-8": "ç™½éœ²", "9-23": "ç§‹åˆ†", "10-9": "å¯’éœ²", "10-24": "éœœé™",
    "11-8": "ç«‹å†¬", "11-23": "å°é›ª", "12-8": "å¤§é›ª", "12-22": "å†¬è‡³"
  },
  2039: {
    "1-5": "å°å¯’", "1-20": "å¤§å¯’", "2-3": "ç«‹æ˜¥", "2-18": "é›¨æ°´",
    "3-5": "æƒŠè›°", "3-20": "æ˜¥åˆ†", "4-4": "æ¸…æ˜", "4-20": "è°·é›¨",
    "5-5": "ç«‹å¤", "5-20": "å°æ»¡", "6-5": "èŠ’ç§", "6-21": "å¤è‡³",
    "7-7": "å°æš‘", "7-22": "å¤§æš‘", "8-7": "ç«‹ç§‹", "8-23": "å¤„æš‘",
    "9-7": "ç™½éœ²", "9-23": "ç§‹åˆ†", "10-8": "å¯’éœ²", "10-23": "éœœé™",
    "11-7": "ç«‹å†¬", "11-22": "å°é›ª", "12-7": "å¤§é›ª", "12-22": "å†¬è‡³"
  },
  2040: {
    "1-5": "å°å¯’", "1-19": "å¤§å¯’", "2-3": "ç«‹æ˜¥", "2-18": "é›¨æ°´",
    "3-5": "æƒŠè›°", "3-20": "æ˜¥åˆ†", "4-4": "æ¸…æ˜", "4-19": "è°·é›¨",
    "5-5": "ç«‹å¤", "5-20": "å°æ»¡", "6-5": "èŠ’ç§", "6-21": "å¤è‡³",
    "7-7": "å°æš‘", "7-22": "å¤§æš‘", "8-7": "ç«‹ç§‹", "8-22": "å¤„æš‘",
    "9-7": "ç™½éœ²", "9-22": "ç§‹åˆ†", "10-7": "å¯’éœ²", "10-22": "éœœé™",
    "11-6": "ç«‹å†¬", "11-21": "å°é›ª", "12-6": "å¤§é›ª", "12-21": "å†¬è‡³"
  }
};
        // å†œå†è½¬æ¢æ ¸å¿ƒç±»
        class LunarConverter {
            static LUNAR_NEW_YEAR = {
                2024: [2, 10], 2025: [1, 29], 2026: [2, 17], 2027: [2, 6], 2028: [1, 26],
                2029: [2, 13], 2030: [2, 3], 2031: [1, 23], 2032: [2, 11], 2033: [1, 31],
                2034: [2, 19], 2035: [2, 8], 2036: [1, 28], 2037: [2, 15], 2038: [2, 4],
                2039: [1, 24], 2040: [2, 12], 2041: [2, 1], 2042: [1, 22], 2043: [2, 10],
                2044: [1, 30], 2045: [2, 17], 2046: [2, 6], 2047: [1, 26], 2048: [2, 14],
                2049: [2, 2], 2050: [1, 23], 2023: [1, 22], 2022: [2, 1], 2021: [2, 12],
                2020: [1, 25], 2019: [2, 5], 2018: [2, 16], 2017: [1, 28], 2016: [2, 8],
                2015: [2, 19], 2014: [1, 31], 2013: [2, 10], 2012: [1, 23], 2011: [2, 3],
                2010: [2, 14], 2009: [1, 26], 2008: [2, 7], 2007: [2, 18], 2006: [1, 29],
                2005: [2, 9], 2004: [1, 22], 2003: [2, 1], 2002: [2, 12], 2001: [1, 24],
                2000: [2, 5], 1999: [2, 16], 1998: [1, 28], 1997: [2, 7], 1996: [2, 19],
                1995: [1, 31], 1994: [2, 10], 1993: [1, 23], 1992: [2, 4], 1991: [2, 15],
                1990: [1, 27], 1989: [2, 6], 1988: [2, 17], 1987: [1, 29], 1986: [2, 9],
                1985: [2, 20], 1984: [2, 2], 1983: [2, 13], 1982: [1, 25], 1981: [2, 5],
                1980: [2, 16], 1979: [1, 28], 1978: [2, 7], 1977: [2, 18], 1976: [1, 31]
            };

            static LUNAR_MONTH_DAYS = [30,29,30,29,30,29,30,30,29,30,29,30];
            static ZODIACS = ['é¼ ','ç‰›','è™','å…”','é¾™','è›‡','é©¬','ç¾Š','çŒ´','é¸¡','ç‹—','çŒª'];
            static LUNAR_MONTHS = ['æ­£æœˆ','äºŒæœˆ','ä¸‰æœˆ','å››æœˆ','äº”æœˆ','å…­æœˆ','ä¸ƒæœˆ','å…«æœˆ','ä¹æœˆ','åæœˆ','å†¬æœˆ','è…Šæœˆ'];
            static LUNAR_DAYS = ['åˆä¸€','åˆäºŒ','åˆä¸‰','åˆå››','åˆäº”','åˆå…­','åˆä¸ƒ','åˆå…«','åˆä¹','åˆå',
                               'åä¸€','åäºŒ','åä¸‰','åå››','åäº”','åå…­','åä¸ƒ','åå…«','åä¹','äºŒå',
                               'å»¿ä¸€','å»¿äºŒ','å»¿ä¸‰','å»¿å››','å»¿äº”','å»¿å…­','å»¿ä¸ƒ','å»¿å…«','å»¿ä¹','ä¸‰å'];

            static getLunarDate(solarDate) {
                const year = solarDate.getFullYear();
                const month = solarDate.getMonth() + 1;
                const day = solarDate.getDate();

                const ny = this.LUNAR_NEW_YEAR[year] || [2, 1];
                const nyMonth = ny[0];
                const nyDay = ny[1];

                let lunarYear = year;
                let lunarMonth = 1;
                let lunarDay = 1;

                if (month < nyMonth || (month === nyMonth && day < nyDay)) {
                    lunarYear -= 1;
                    const lastNy = this.LUNAR_NEW_YEAR[lunarYear] || [2, 1];
                    const daysPassed = this.getDaysBetween(
                        new Date(lunarYear, lastNy[0]-1, lastNy[1]),
                        solarDate
                    );
                    const lunarDate = this.calcLunarDayFromDays(daysPassed);
                    lunarMonth = lunarDate.month;
                    lunarDay = lunarDate.day;
                } else {
                    const daysPassed = this.getDaysBetween(
                        new Date(year, nyMonth-1, nyDay),
                        solarDate
                    );
                    const lunarDate = this.calcLunarDayFromDays(daysPassed);
                    lunarMonth = lunarDate.month;
                    lunarDay = lunarDate.day;
                }

                const zodiac = this.ZODIACS[(lunarYear - 1900) % 12];
                
                return {
                    year: lunarYear,
                    month: this.LUNAR_MONTHS[lunarMonth - 1],
                    day: this.LUNAR_DAYS[lunarDay - 1],
                    zodiac: zodiac,
                    fullText: `${lunarYear}å¹´(${zodiac}) ${this.LUNAR_MONTHS[lunarMonth - 1]}${this.LUNAR_DAYS[lunarDay - 1]}`,
                    monthNum: lunarMonth,
                    dayNum: lunarDay
                };
            }

            static getSolarFromLunar(targetYear, lunarMonth, lunarDay) {
                const ny = this.LUNAR_NEW_YEAR[targetYear] || [2, 1];
                const newYear = new Date(targetYear, ny[0]-1, ny[1]);
                
                let totalDays = 0;
                for (let i = 0; i < lunarMonth - 1; i++) {
                    totalDays += this.LUNAR_MONTH_DAYS[i];
                }
                totalDays += lunarDay - 1;
                
                const solarDate = new Date(newYear);
                solarDate.setDate(solarDate.getDate() + totalDays);
                
                return {
                    year: solarDate.getFullYear(),
                    month: solarDate.getMonth() + 1,
                    day: solarDate.getDate()
                };
            }

            static getDaysBetween(date1, date2) {
                const oneDay = 24 * 60 * 60 * 1000;
                const diffTime = Math.abs(date2 - date1);
                return Math.floor(diffTime / oneDay);
            }

            static calcLunarDayFromDays(days) {
                let month = 1;
                let day = days + 1;
                
                for (let i = 0; i < this.LUNAR_MONTH_DAYS.length; i++) {
                    const monthDays = this.LUNAR_MONTH_DAYS[i];
                    if (day > monthDays) {
                        day -= monthDays;
                        month++;
                    } else {
                        break;
                    }
                }

                return { month, day };
            }
        }

        // ç”Ÿæ—¥ç®¡ç†
        function getBirthdays() {
            const birthdays = localStorage.getItem('birthdays');
            return birthdays ? JSON.parse(birthdays) : [];
        }

        function saveBirthday(birthday) {
            const birthdays = getBirthdays();
            birthdays.push(birthday);
            localStorage.setItem('birthdays', JSON.stringify(birthdays));
        }

        function checkBirthdayReminder(today) {
            const birthdays = getBirthdays();
            if (birthdays.length === 0) return null;
            
            const todaySolar = { month: today.getMonth() + 1, day: today.getDate() };
            const todayLunar = LunarConverter.getLunarDate(today);
            
            for (const birthday of birthdays) {
                if (birthday.type === 'solar' && birthday.month === todaySolar.month && birthday.day === todaySolar.day) {
                    return `${birthday.name}çš„å…¬å†ç”Ÿæ—¥ ğŸ‚`;
                }
                
                if (birthday.type === 'lunar' && birthday.lunarMonth === todayLunar.monthNum && birthday.lunarDay === todayLunar.dayNum) {
                    return `${birthday.name}çš„å†œå†ç”Ÿæ—¥ ğŸ‚`;
                }
            }
            
            return null;
        }

        function initAddBirthdayBtn() {
            document.getElementById('add-birthday-btn').addEventListener('click', () => {
                const name = prompt('è¯·è¾“å…¥å¯¿æ˜Ÿå§“åï¼š');
                if (!name) return;
                
                const type = prompt('è¯·é€‰æ‹©ç”Ÿæ—¥ç±»å‹ï¼ˆè¾“å…¥ 1 è¡¨ç¤ºå…¬å†ï¼Œ2 è¡¨ç¤ºå†œå†ï¼‰ï¼š');
                if (!['1', '2'].includes(type)) {
                    alert('è¯·è¾“å…¥ 1 æˆ– 2 é€‰æ‹©ç”Ÿæ—¥ç±»å‹ï¼');
                    return;
                }
                const birthdayType = type === '1' ? 'solar' : 'lunar';
                
                if (birthdayType === 'solar') {
                    const month = prompt('è¯·è¾“å…¥å…¬å†æœˆä»½ï¼ˆ1-12ï¼‰ï¼š');
                    if (!month || month < 1 || month > 12) { alert('æœˆä»½è¾“å…¥é”™è¯¯ï¼'); return; }
                    const day = prompt('è¯·è¾“å…¥å…¬å†æ—¥æœŸï¼ˆ1-31ï¼‰ï¼š');
                    if (!day || day < 1 || day > 31) { alert('æ—¥æœŸè¾“å…¥é”™è¯¯ï¼'); return; }
                    
                    saveBirthday({
                        name, type: 'solar', month: parseInt(month), day: parseInt(day),
                        createTime: new Date().toISOString()
                    });
                    alert(`${name}çš„å…¬å†ç”Ÿæ—¥ï¼ˆ${month}æœˆ${day}æ—¥ï¼‰å·²æ·»åŠ ï¼Œæ¯å¹´è‡ªåŠ¨æé†’ï¼`);
                } else {
                    const lunarMonth = prompt('è¯·è¾“å…¥å†œå†æœˆä»½ï¼ˆ1-12ï¼Œ1=æ­£æœˆï¼Œ12=è…Šæœˆï¼‰ï¼š');
                    if (!lunarMonth || lunarMonth < 1 || lunarMonth > 12) { alert('å†œå†æœˆä»½è¾“å…¥é”™è¯¯ï¼'); return; }
                    const lunarDay = prompt('è¯·è¾“å…¥å†œå†æ—¥æœŸï¼ˆ1-30ï¼‰ï¼š');
                    if (!lunarDay || lunarDay < 1 || lunarDay > 30) { alert('å†œå†æ—¥æœŸè¾“å…¥é”™è¯¯ï¼'); return; }
                    
                    saveBirthday({
                        name, type: 'lunar', lunarMonth: parseInt(lunarMonth), lunarDay: parseInt(lunarDay),
                        createTime: new Date().toISOString()
                    });
                    alert(`${name}çš„å†œå†ç”Ÿæ—¥ï¼ˆ${LunarConverter.LUNAR_MONTHS[parseInt(lunarMonth)-1]}${LunarConverter.LUNAR_DAYS[parseInt(lunarDay)-1]}ï¼‰å·²æ·»åŠ ï¼Œæ¯å¹´è‡ªåŠ¨æé†’ï¼`);
                }
            });
        }

        // è‡ªå®šä¹‰æ—¥æœŸåŠŸèƒ½ - ä¿®å¤æŒ‰é’®ç‚¹å‡»æ— å“åº”é—®é¢˜
        function initAddCustomDateBtn() {
            document.getElementById('add-custom-date-btn').addEventListener('click', () => {
                const content = prompt('è¯·è¾“å…¥è‡ªå®šä¹‰æ—¥æœŸçš„å†…å®¹ï¼ˆå¦‚ï¼šçºªå¿µæ—¥ã€é‡è¦äº‹ä»¶ï¼‰ï¼š');
                if (!content) return;
                
                const dateStr = prompt('è¯·è¾“å…¥æ—¥æœŸï¼ˆæ ¼å¼ï¼šYYYY-MM-DDï¼Œå¦‚ï¼š2025-05-20ï¼‰ï¼š');
                if (!dateStr) return;
                
                const dateRegex = /^\d{4}-\d{2}-\d{2}$/;
                if (!dateRegex.test(dateStr)) {
                    alert('æ—¥æœŸæ ¼å¼é”™è¯¯ï¼è¯·è¾“å…¥å¦‚ 2025-05-20 è¿™æ ·çš„æ ¼å¼');
                    return;
                }
                
                const date = new Date(dateStr);
                if (isNaN(date.getTime())) {
                    alert('æ—¥æœŸæ— æ•ˆï¼è¯·æ£€æŸ¥è¾“å…¥çš„æ—¥æœŸæ˜¯å¦æ­£ç¡®');
                    return;
                }
                
                const year = date.getFullYear();
                const month = date.getMonth() + 1;
                const day = date.getDate();
                const dateKey = `${year}-${month}-${day}`;
                
                saveCustomDate(dateKey, content);
                alert(`å·²æ·»åŠ è‡ªå®šä¹‰æ—¥æœŸï¼š${dateStr} - ${content}`);
                
                // ç«‹å³æ›´æ–°èŠ‚æ—¥æ˜¾ç¤º
                const now = new Date();
                const lunar = LunarConverter.getLunarDate(now);
                document.getElementById('festival-info').textContent = getTodayFestival(now, lunar);
            });
        }

        // èŠ‚æ—¥/è‡ªå®šä¹‰æ—¥æœŸ
        const FESTIVALS = {
            "1-1": "å…ƒæ—¦", "2-14": "æƒ…äººèŠ‚", "3-8": "å¦‡å¥³èŠ‚", "3-12": "æ¤æ ‘èŠ‚", "4-1": "æ„šäººèŠ‚",
            "5-1": "åŠ³åŠ¨èŠ‚", "5-4": "é’å¹´èŠ‚", "6-1": "å„¿ç«¥èŠ‚", "7-1": "å»ºå…šèŠ‚", "8-1": "å»ºå†›èŠ‚",
            "9-10": "æ•™å¸ˆèŠ‚", "10-1": "å›½åº†èŠ‚", "12-25": "åœ£è¯èŠ‚",
            "lunar-1-1": "æ˜¥èŠ‚", "lunar-1-15": "å…ƒå®µèŠ‚", "lunar-5-5": "ç«¯åˆèŠ‚",
            "lunar-8-15": "ä¸­ç§‹èŠ‚", "lunar-9-9": "é‡é˜³èŠ‚"
        };

        function getCustomDates() {
            const customDates = localStorage.getItem('customDates');
            return customDates ? JSON.parse(customDates) : {};
        }

        function saveCustomDate(dateKey, content) {
            const customDates = getCustomDates();
            customDates[dateKey] = content;
            localStorage.setItem('customDates', JSON.stringify(customDates));
        }

        function getTodayFestival(solarDate, lunarDate) {
            const year = solarDate.getFullYear();
            const month = solarDate.getMonth() + 1;
            const day = solarDate.getDate();
            
            const todayEvents = [];

            const birthdayReminder = checkBirthdayReminder(solarDate);
            if (birthdayReminder) {
            todayEvents.push(birthdayReminder);
        }
            
            const termKey = `${month}-${day}`;
            if (SOLAR_TERMS[year] && SOLAR_TERMS[year][termKey]) {
            todayEvents.push(SOLAR_TERMS[year][termKey] + " ğŸ‹");
        }

  const solarKey = `${month}-${day}`;
  if (FESTIVALS[solarKey]) {
    todayEvents.push(FESTIVALS[solarKey]);
  }

  // 4. æ·»åŠ å†œå†èŠ‚æ—¥
  const lunarKey = `lunar-${lunarDate.monthNum}-${lunarDate.dayNum}`;
  if (FESTIVALS[lunarKey]) {
    todayEvents.push(FESTIVALS[lunarKey] + " ğŸŒ•");
  }

  // 5. æ·»åŠ è‡ªå®šä¹‰æ—¥æœŸ
  const customKey = `${year}-${month}-${day}`;
  const customDates = getCustomDates();
  if (customDates[customKey]) {
    todayEvents.push(customDates[customKey]);
  }

  // 6. æ— ä»»ä½•äº‹ä»¶æ—¶æ˜¾ç¤ºé»˜è®¤æ–‡æœ¬
  if (todayEvents.length === 0) {
    todayEvents.push("æ™®é€šçš„ä¸€å¤©");
  }

  // è®¾ç½®æ ·å¼ï¼ˆæœ‰ç”Ÿæ—¥æé†’åˆ™æ˜¾ç¤ºæé†’æ ·å¼ï¼Œå¦åˆ™æ˜¾ç¤ºèŠ‚æ—¥æ ·å¼ï¼‰
  document.getElementById('festival-info').className = birthdayReminder ? 'reminder-tag' : 'festival-tag';
  
  // æ‹¼æ¥æ‰€æœ‰äº‹ä»¶ï¼ˆç”¨ / åˆ†éš”ï¼Œå®ç°å¤šèŠ‚æ—¥åŒæ—¶æ˜¾ç¤ºï¼‰
  return todayEvents.join(' / ');
}

        // å€’è®¡æ—¶åŠŸèƒ½
        function getCountdowns() {
            const countdowns = localStorage.getItem('countdowns');
            return countdowns ? JSON.parse(countdowns) : [];
        }

        function saveCountdown(countdown) {
            const countdowns = getCountdowns();
            countdowns.push({ ...countdown, createTime: new Date().toISOString() });
            localStorage.setItem('countdowns', JSON.stringify(countdowns));
            updateCountdownDisplay();
        }

        function calculateCountdown(targetDate) {
            const now = new Date();
            const target = new Date(targetDate);
            const diffTime = target - now;
            
            if (diffTime <= 0) return "å·²è¿‡æœŸ";
            
            const days = Math.floor(diffTime / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diffTime % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((diffTime % (1000 * 60 * 60)) / (1000 * 60));
            
            if (days > 0) return `${days}å¤©${hours}å°æ—¶${minutes}åˆ†é’Ÿ`;
            else if (hours > 0) return `${hours}å°æ—¶${minutes}åˆ†é’Ÿ`;
            else return `${minutes}åˆ†é’Ÿ`;
        }

        function updateCountdownDisplay() {
            const countdowns = getCountdowns();
            const displayEl = document.getElementById('countdown-display');
            
            if (countdowns.length === 0) {
                displayEl.classList.add('hidden');
                return;
            }
            
            const now = new Date();
            let nearestCountdown = null;
            let minDiff = Infinity;
            
            countdowns.forEach(countdown => {
                const target = new Date(countdown.targetDate);
                const diff = target - now;
                if (diff > 0 && diff < minDiff) {
                    minDiff = diff;
                    nearestCountdown = countdown;
                }
            });
            
            if (nearestCountdown) {
                const timeLeft = calculateCountdown(nearestCountdown.targetDate);
                displayEl.textContent = `${nearestCountdown.name}ï¼šè¿˜æœ‰ ${timeLeft}`;
                displayEl.classList.remove('hidden');
            } else {
                displayEl.classList.add('hidden');
            }
        }

        function initAddCountdownBtn() {
            document.getElementById('add-countdown-btn').addEventListener('click', () => {
                const name = prompt('è¯·è¾“å…¥å€’è®¡æ—¶åç§°ï¼ˆå¦‚ï¼šæ˜¥èŠ‚ã€è€ƒè¯•ã€æ—…è¡Œï¼‰ï¼š');
                if (!name) return;
                
                const dateStr = prompt('è¯·è¾“å…¥ç›®æ ‡æ—¥æœŸï¼ˆæ ¼å¼ï¼šYYYY-MM-DDï¼Œå¦‚ï¼š2025-01-29ï¼‰ï¼š');
                if (!dateStr) return;
                
                const dateRegex = /^\d{4}-\d{2}-\d{2}$/;
                if (!dateRegex.test(dateStr)) {
                    alert('æ—¥æœŸæ ¼å¼é”™è¯¯ï¼è¯·è¾“å…¥å¦‚ 2025-01-29 è¿™æ ·çš„æ ¼å¼');
                    return;
                }
                
                const targetDate = new Date(dateStr);
                if (isNaN(targetDate.getTime())) {
                    alert('æ—¥æœŸæ— æ•ˆï¼è¯·æ£€æŸ¥è¾“å…¥çš„æ—¥æœŸæ˜¯å¦æ­£ç¡®');
                    return;
                }
                
                const now = new Date();
                if (targetDate < now && !confirm('ä½ è¾“å…¥çš„æ—¥æœŸå·²è¿‡æœŸï¼Œæ˜¯å¦ä»è¦æ·»åŠ ï¼Ÿ')) return;
                
                saveCountdown({
                    name, targetDate: targetDate.toISOString().split('T')[0], type: 'custom'
                });
                
                alert(`${name}ï¼ˆ${dateStr}ï¼‰å€’è®¡æ—¶å·²æ·»åŠ ï¼`);
            });
        }

        // å•ä½æ¢ç®—
        function initConverter() {
            const convertType = document.getElementById('convert-type');
            const inputValue = document.getElementById('input-value');
            const inputUnit = document.getElementById('input-unit');
            const outputUnit = document.getElementById('output-unit');
            const convertResult = document.getElementById('convert-result');
            const swapBtn = document.getElementById('swap-units');
            
            const unitConfigs = {
                length: {
                    units: [
                        { value: 'meter', label: 'ç±³' }, { value: 'foot', label: 'è‹±å°º' }, { value: 'inch', label: 'è‹±å¯¸' },
                        { value: 'kilometer', label: 'åƒç±³' }, { value: 'mile', label: 'è‹±é‡Œ' },
                        { value: 'chi', label: 'å°º' }, { value: 'cun', label: 'å¯¸' }, { value: 'li', label: 'é‡Œ' }, { value: 'zhang', label: 'ä¸ˆ' }
                    ],
                    convert: (value, fromUnit, toUnit) => {
                        let meters;
                        switch(fromUnit) {
                            case 'meter': meters = value; break;
                            case 'foot': meters = value * 0.3048; break;
                            case 'inch': meters = value * 0.0254; break;
                            case 'kilometer': meters = value * 1000; break;
                            case 'mile': meters = value * 1609.34; break;
                            case 'chi': meters = value * 1/3; break;
                            case 'cun': meters = value * 1/30; break;
                            case 'li': meters = value * 500; break;
                            case 'zhang': meters = value * 10/3; break;
                            default: meters = value;
                        }
                        
                        let result;
                        switch(toUnit) {
                            case 'meter': result = meters; break;
                            case 'foot': result = meters / 0.3048; break;
                            case 'inch': result = meters / 0.0254; break;
                            case 'kilometer': result = meters / 1000; break;
                            case 'mile': result = meters / 1609.34; break;
                            case 'chi': result = meters * 3; break;
                            case 'cun': result = meters * 30; break;
                            case 'li': result = meters / 500; break;
                            case 'zhang': result = meters * 3/10; break;
                            default: result = meters;
                        }
                        
                        return result;
                    }
                },
                weight: {
                    units: [
                        { value: 'kg', label: 'åƒå…‹' }, { value: 'g', label: 'å…‹' }, { value: 'lb', label: 'ç£…' },
                        { value: 'jin', label: 'æ–¤' }, { value: 'liang', label: 'ä¸¤' }
                    ],
                    convert: (value, fromUnit, toUnit) => {
                        let kg;
                        switch(fromUnit) {
                            case 'kg': kg = value; break;
                            case 'g': kg = value / 1000; break;
                            case 'lb': kg = value * 0.453592; break;
                            case 'jin': kg = value * 0.5; break;
                            case 'liang': kg = value * 0.05; break;
                            default: kg = value;
                        }
                        
                        let result;
                        switch(toUnit) {
                            case 'kg': result = kg; break;
                            case 'g': result = kg * 1000; break;
                            case 'lb': result = kg / 0.453592; break;
                            case 'jin': result = kg * 2; break;
                            case 'liang': result = kg * 20; break;
                            default: result = kg;
                        }
                        
                        return result;
                    }
                },
                temp: {
                    units: [
                        { value: 'c', label: 'æ‘„æ°åº¦' }, { value: 'f', label: 'åæ°åº¦' }, { value: 'k', label: 'å¼€å°”æ–‡' }
                    ],
                    convert: (value, fromUnit, toUnit) => {
                        let c;
                        switch(fromUnit) {
                            case 'c': c = value; break;
                            case 'f': c = (value - 32) * 5/9; break;
                            case 'k': c = value - 273.15; break;
                            default: c = value;
                        }
                        
                        let result;
                        switch(toUnit) {
                            case 'c': result = c; break;
                            case 'f': result = c * 9/5 + 32; break;
                            case 'k': result = c + 273.15; break;
                            default: result = c;
                        }
                        
                        return result;
                    }
                },
                time: {
                    units: [
                        { value: 'second', label: 'ç§’' }, { value: 'minute', label: 'åˆ†é’Ÿ' }, { value: 'hour', label: 'å°æ—¶' },
                        { value: 'day', label: 'å¤©' }, { value: 'week', label: 'å‘¨' }
                    ],
                    convert: (value, fromUnit, toUnit) => {
                        let seconds;
                        switch(fromUnit) {
                            case 'second': seconds = value; break;
                            case 'minute': seconds = value * 60; break;
                            case 'hour': seconds = value * 3600; break;
                            case 'day': seconds = value * 86400; break;
                            case 'week': seconds = value * 604800; break;
                            default: seconds = value;
                        }
                        
                        let result;
                        switch(toUnit) {
                            case 'second': result = seconds; break;
                            case 'minute': result = seconds / 60; break;
                            case 'hour': result = seconds / 3600; break;
                            case 'day': result = seconds / 86400; break;
                            case 'week': result = seconds / 604800; break;
                            default: result = seconds;
                        }
                        
                        return result;
                    }
                },
                area: {
                    units: [
                        { value: 'sqm', label: 'å¹³æ–¹ç±³' }, { value: 'sqkm', label: 'å¹³æ–¹åƒç±³' },
                        { value: 'sqft', label: 'å¹³æ–¹è‹±å°º' }, { value: 'acre', label: 'è‹±äº©' },
                        { value: 'mu', label: 'äº©' }
                    ],
                    convert: (value, fromUnit, toUnit) => {
                        let sqm;
                        switch(fromUnit) {
                            case 'sqm': sqm = value; break;
                            case 'sqkm': sqm = value * 1000000; break;
                            case 'sqft': sqm = value * 0.092903; break;
                            case 'acre': sqm = value * 4046.86; break;
                            case 'mu': sqm = value * 666.667; break;
                            default: sqm = value;
                        }
                        
                        let result;
                        switch(toUnit) {
                            case 'sqm': result = sqm; break;
                            case 'sqkm': result = sqm / 1000000; break;
                            case 'sqft': result = sqm / 0.092903; break;
                            case 'acre': result = sqm / 4046.86; break;
                            case 'mu': result = sqm / 666.667; break;
                            default: result = sqm;
                        }
                        
                        return result;
                    }
                }
            };
            
            // æ›´æ–°å•ä½ä¸‹æ‹‰æ¡†
            function updateUnitDropdowns(type) {
                const config = unitConfigs[type];
                const inputUnitHtml = config.units.map(unit => 
                    `<option value="${unit.value}">${unit.label}</option>`
                ).join('');
                const outputUnitHtml = config.units.map(unit => 
                    `<option value="${unit.value}">${unit.label}</option>`
                ).join('');
                
                inputUnit.innerHTML = inputUnitHtml;
                outputUnit.innerHTML = outputUnitHtml;
                
                // é»˜è®¤é€‰ä¸­ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ª
                if (config.units.length > 1) {
                    inputUnit.selectedIndex = 0;
                    outputUnit.selectedIndex = 1;
                }
            }
            
            // åˆå§‹åŒ–é•¿åº¦å•ä½
            updateUnitDropdowns('length');
            
            // ç±»å‹åˆ‡æ¢äº‹ä»¶
            convertType.addEventListener('change', () => {
                updateUnitDropdowns(convertType.value);
                convert();
            });
            
            // æ¢ç®—è®¡ç®—
            function convert() {
                const type = convertType.value;
                const value = parseFloat(inputValue.value);
                
                if (isNaN(value)) {
                    convertResult.textContent = "è¯·è¾“å…¥æ•°å€¼è¿›è¡Œæ¢ç®—";
                    return;
                }
                
                const fromUnit = inputUnit.value;
                const toUnit = outputUnit.value;
                const config = unitConfigs[type];
                
                const result = config.convert(value, fromUnit, toUnit);
                convertResult.textContent = result.toFixed(6).replace(/\.?0*$/, '') || '0';
            }
            
            // è¾“å…¥å˜åŒ–äº‹ä»¶
            inputValue.addEventListener('input', convert);
            inputUnit.addEventListener('change', convert);
            outputUnit.addEventListener('change', convert);
            
            // äº¤æ¢å•ä½
            swapBtn.addEventListener('click', () => {
                const temp = inputUnit.value;
                inputUnit.value = outputUnit.value;
                outputUnit.value = temp;
                convert();
            });
        }
            
document.getElementById('tab-converter').addEventListener('click', () => {
    // åŸæœ‰æ ·å¼åˆ‡æ¢é€»è¾‘
    document.getElementById('tab-converter').classList.add('text-primary', 'border-b-2', 'border-primary');
    document.getElementById('tab-converter').classList.remove('text-secondary');
    document.getElementById('tab-calculator').classList.remove('text-primary', 'border-b-2', 'border-primary');
    document.getElementById('tab-calculator').classList.add('text-secondary');
    // æ–°å¢ï¼šéšè—äº²å±é¢æ¿
    document.getElementById('tab-relative').classList.remove('text-primary', 'border-b-2', 'border-primary');
    document.getElementById('tab-relative').classList.add('text-secondary');
    
    // é¢æ¿æ˜¾ç¤ºé€»è¾‘
    document.getElementById('converter-panel').classList.remove('hidden');
    document.getElementById('calculator-panel').classList.add('hidden');
    document.getElementById('relative-panel').classList.add('hidden');
});

document.getElementById('tab-calculator').addEventListener('click', () => {
    // åŸæœ‰æ ·å¼åˆ‡æ¢é€»è¾‘
    document.getElementById('tab-calculator').classList.add('text-primary', 'border-b-2', 'border-primary');
    document.getElementById('tab-calculator').classList.remove('text-secondary');
    document.getElementById('tab-converter').classList.remove('text-primary', 'border-b-2', 'border-primary');
    document.getElementById('tab-converter').classList.add('text-secondary');
    document.getElementById('tab-relative').classList.remove('text-primary', 'border-b-2', 'border-primary');
    document.getElementById('tab-relative').classList.add('text-secondary');
    
    // é¢æ¿æ˜¾ç¤ºé€»è¾‘
    document.getElementById('calculator-panel').classList.remove('hidden');
    document.getElementById('converter-panel').classList.add('hidden');
    document.getElementById('relative-panel').classList.add('hidden');
});            

document.getElementById('tab-relative').addEventListener('click', () => {
    // åŸæœ‰æ ·å¼åˆ‡æ¢é€»è¾‘
    document.getElementById('tab-calculator').classList.remove('text-primary', 'border-b-2', 'border-primary');
    document.getElementById('tab-calculator').classList.add('text-secondary');
    document.getElementById('tab-converter').classList.remove('text-primary', 'border-b-2', 'border-primary');
    document.getElementById('tab-converter').classList.add('text-secondary');
    document.getElementById('tab-relative').classList.add('text-primary', 'border-b-2', 'border-primary');
    document.getElementById('tab-relative').classList.remove('text-secondary');
    
    // é¢æ¿æ˜¾ç¤ºé€»è¾‘
    document.getElementById('relative-panel').classList.remove('hidden');
    document.getElementById('converter-panel').classList.add('hidden');
    document.getElementById('calculator-panel').classList.add('hidden');
});            
            // åˆå§‹åŒ–è®¡ç®—å™¨åŠŸèƒ½
            function initCalculator() {
                const calcProcess = document.getElementById('calc-process');
                const calcResult = document.getElementById('calc-result');
                let calcHistory = ''; // ä¿å­˜ç­‰å·å‰çš„è¾“å…¥å†…å®¹
                let isCalculated = false; // æ˜¯å¦å·²ç‚¹å‡»ç­‰å·

                // ç»‘å®šè®¡ç®—å™¨æŒ‰é’®äº‹ä»¶
                const calcButtons = document.querySelectorAll('.calc-btn');
                calcButtons.forEach(btn => {
                    btn.addEventListener('click', () => {
                        const value = btn.getAttribute('data-value');

                        // ACï¼šæ¸…ç©ºæ‰€æœ‰
                        if (value === 'AC') {
                            calcProcess.textContent = '';
                            calcResult.textContent = '';
                            calcHistory = '';
                            isCalculated = false;
                            return;
                        }

                        // DELï¼šåˆ é™¤æœ€åä¸€ä¸ªå­—ç¬¦
                        if (value === 'DEL') {
                            // å¦‚æœå·²è®¡ç®—ï¼Œç‚¹å‡»DELå›åˆ°è®¡ç®—å‰çŠ¶æ€
                            if (isCalculated) {
                                calcProcess.textContent = calcHistory;
                                calcResult.textContent = '';
                                isCalculated = false;
                            } else {
                                // æœªè®¡ç®—æ—¶åˆ é™¤æœ€åä¸€ä¸ªå­—ç¬¦
                                const current = calcProcess.textContent;
                                calcProcess.textContent = current.slice(0, -1);
                            }
                            return;
                        }

                        // ç­‰å·ï¼šè®¡ç®—ç»“æœ
                        if (value === '=') {
                            if (!calcProcess.textContent) return;
                            try {
                                // ä¿å­˜è®¡ç®—å‰çš„è¾“å…¥
                                calcHistory = calcProcess.textContent;
                                // æ›¿æ¢Ã—ä¸º*ï¼Œå¤„ç†è®¡ç®—
                                const expression = calcProcess.textContent.replace(/Ã—/g, '*');
                                // å®‰å…¨è®¡ç®—ï¼ˆé¿å…evalçš„å®‰å…¨é—®é¢˜ï¼Œç®€åŒ–ç‰ˆï¼‰
                                const result = Function(`'use strict'; return (${expression})`)();
                                calcResult.textContent = result;
                                isCalculated = true;
                            } catch (e) {
                                calcResult.textContent = 'è®¡ç®—é”™è¯¯';
                            }
                            return;
                        }

                        // æ™®é€šæŒ‰é”®ï¼šæ•°å­—/ç¬¦å·
                        // å¦‚æœå·²è®¡ç®—ï¼Œç‚¹å‡»æ–°æŒ‰é”®æ¸…ç©ºç»“æœå¹¶å¼€å§‹æ–°è¾“å…¥
                        if (isCalculated) {
                            calcProcess.textContent = value;
                            calcResult.textContent = '';
                            isCalculated = false;
                        } else {
                            // æœªè®¡ç®—æ—¶è¿½åŠ å†…å®¹
                            calcProcess.textContent += value;
                        }
                    });
                });
            }

        // åˆå§‹åŒ–å¤‡å¿˜å½•
        function initNotes() {
            const noteTitle = document.getElementById('note-title');
            const noteContent = document.getElementById('note-content');
            const saveNote = document.getElementById('save-note');
            const clearNote = document.getElementById('clear-note');
            const deleteAllNotes = document.getElementById('delete-all-notes');
            const notesList = document.getElementById('notes-list');
            const emptyTip = document.getElementById('empty-tip');
            const currentNoteId = document.getElementById('current-note-id');
            
            // è·å–å¤‡å¿˜å½•
            function getNotes() {
                const notes = localStorage.getItem('notes');
                return notes ? JSON.parse(notes) : [];
            }
            
            // ä¿å­˜å¤‡å¿˜å½•
            function saveNotes(notes) {
                localStorage.setItem('notes', JSON.stringify(notes));
                renderNotes();
            }
            
            // æ¸²æŸ“å¤‡å¿˜å½•åˆ—è¡¨
            function renderNotes() {
                const notes = getNotes();
                notesList.innerHTML = '';
                
                if (notes.length === 0) {
                    notesList.appendChild(emptyTip);
                    return;
                }
                
                notes.forEach(note => {
                    const item = document.createElement('div');
                    item.className = 'note-item';
                    item.innerHTML = `
                        <h4>${note.title}</h4>
                        <p>${note.content}</p>
                        <div class="note-actions">
                            <button class="edit-btn" data-id="${note.id}">ç¼–è¾‘</button>
                            <button class="delete-btn" data-id="${note.id}">åˆ é™¤</button>
                        </div>
                    `;
                    notesList.appendChild(item);
                });
                
                // ç»‘å®šç¼–è¾‘åˆ é™¤äº‹ä»¶
                document.querySelectorAll('.edit-btn').forEach(btn => {
                    btn.addEventListener('click', () => editNote(btn.dataset.id));
                });
                
                document.querySelectorAll('.delete-btn').forEach(btn => {
                    btn.addEventListener('click', () => deleteNote(btn.dataset.id));
                });
            }
            
            // æ·»åŠ /ç¼–è¾‘å¤‡å¿˜å½•
            function addNote() {
                const title = noteTitle.value.trim();
                const content = noteContent.value.trim();
                
                if (!title) {
                    alert('è¯·è¾“å…¥æ ‡é¢˜');
                    return;
                }
                
                const notes = getNotes();
                const id = currentNoteId.value || Date.now().toString();
                
                // ç¼–è¾‘æ¨¡å¼
                if (currentNoteId.value) {
                    const index = notes.findIndex(n => n.id === id);
                    if (index !== -1) {
                        notes[index] = { id, title, content };
                    }
                } else {
                    // æ–°å¢æ¨¡å¼
                    notes.push({ id, title, content });
                }
                
                saveNotes(notes);
                clearForm();
            }
            
            // ç¼–è¾‘å¤‡å¿˜å½•
            function editNote(id) {
                const notes = getNotes();
                const note = notes.find(n => n.id === id);
                
                if (note) {
                    noteTitle.value = note.title;
                    noteContent.value = note.content;
                    currentNoteId.value = note.id;
                }
            }
            
            // åˆ é™¤å¤‡å¿˜å½•
            function deleteNote(id) {
                if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™æ¡å¤‡å¿˜å½•å—ï¼Ÿ')) return;
                
                let notes = getNotes();
                notes = notes.filter(n => n.id !== id);
                saveNotes(notes);
            }
            
            // æ¸…ç©ºè¡¨å•
            function clearForm() {
                noteTitle.value = '';
                noteContent.value = '';
                currentNoteId.value = '';
            }
            
            // æ¸…ç©ºæ‰€æœ‰
            function deleteAll() {
                if (!confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰å¤‡å¿˜å½•å—ï¼Ÿ')) return;
                saveNotes([]);
            }
            
            // ç»‘å®šäº‹ä»¶
            saveNote.addEventListener('click', addNote);
            clearNote.addEventListener('click', clearForm);
            deleteAllNotes.addEventListener('click', deleteAll);
            
            // åˆå§‹åŒ–æ¸²æŸ“
            renderNotes();
        }

        // å¿«æ·å¯¼èˆªç®¡ç†
        function getCustomSites() {
            const sites = localStorage.getItem('customSites');
            return sites ? JSON.parse(sites) : [];
        }

        function saveCustomSite(site) {
            const sites = getCustomSites();
            sites.push({
                id: Date.now().toString(), 
                name: site.name,
                url: site.url,
                icon: site.icon || '',
                typeId: site.typeId, 
                typeName: site.typeName, 
                typeEmoji: site.typeEmoji 
            });
            localStorage.setItem('customSites', JSON.stringify(sites));
            renderCustomSites();
        }

        // åˆ é™¤è‡ªå®šä¹‰ç½‘ç«™
        function deleteCustomSite(siteId) {
            if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªç½‘ç«™å¿«æ·å…¥å£å—ï¼Ÿ')) return;
            
            let sites = getCustomSites();
            sites = sites.filter(site => site.id !== siteId);
            localStorage.setItem('customSites', JSON.stringify(sites));
            renderCustomSites();
        }

        // å›¾æ ‡æ¸²æŸ“é€»è¾‘
        function renderCustomSites() {
            const container = document.getElementById('custom-sites-container');
            container.innerHTML = '';
            
            const sites = getCustomSites();
            sites.forEach(site => {
                const siteCard = document.createElement('a');
                siteCard.href = site.url;
                siteCard.target = '_blank';
                siteCard.className = 'nav-card';
                siteCard.dataset.siteId = site.id; // å­˜å‚¨ID
                
                // åˆ é™¤æŒ‰é’®
                const deleteBtn = document.createElement('div');
                deleteBtn.className = 'delete-btn';
                deleteBtn.innerHTML = '<i class="fa fa-times"></i>'; // å‰å·å›¾æ ‡
                deleteBtn.addEventListener('click', (e) => {
                    e.preventDefault(); // é˜»æ­¢è·³è½¬
                    e.stopPropagation();
                    deleteCustomSite(site.id);
                });
                
                // å›¾æ ‡å®¹å™¨
                const iconWrapper = document.createElement('div');
                iconWrapper.className = 'nav-icon-wrapper bg-primary/10';
                
                // åˆ›å»ºemojiå…ƒç´ ï¼ˆä½œä¸ºå¤‡ç”¨ï¼‰
                const emojiElement = document.createElement('div');
                emojiElement.className = 'emoji-icon';
                emojiElement.textContent = site.typeEmoji;
                
                // ä¼˜å…ˆä½¿ç”¨è‡ªå®šä¹‰å›¾æ ‡ï¼Œå¦åˆ™ä½¿ç”¨ç½‘ç«™faviconï¼Œæœ€åä½¿ç”¨ç±»å‹emoji
                if (site.icon) {
                    // ä½¿ç”¨è‡ªå®šä¹‰å›¾æ ‡
                    const iconImg = document.createElement('img');
                    iconImg.alt = `${site.name}å›¾æ ‡`;
                    iconImg.className = 'w-6 h-6 object-contain';
                    iconImg.src = site.icon;
                    
                    // å…ˆæ·»åŠ å›¾ç‰‡
                    iconWrapper.appendChild(iconImg);
                    
                    // å›¾æ ‡åŠ è½½å¤±è´¥æ—¶æ˜¾ç¤ºemoji
                    iconImg.onerror = function() {
                        // ç§»é™¤å¤±è´¥çš„å›¾ç‰‡ï¼Œæ·»åŠ emoji
                        iconWrapper.removeChild(iconImg);
                        iconWrapper.appendChild(emojiElement);
                    };
                } else {
                    try {
                        // å°è¯•åŠ è½½ç½‘ç«™favicon
                        const urlObj = new URL(site.url);
                        const iconImg = document.createElement('img');
                        iconImg.alt = `${site.name}å›¾æ ‡`;
                        iconImg.className = 'w-6 h-6 object-contain';
                        iconImg.src = `${urlObj.protocol}//${urlObj.host}/favicon.ico`;
                        
                        // å…ˆæ·»åŠ å›¾ç‰‡
                        iconWrapper.appendChild(iconImg);
                        
                        // faviconåŠ è½½å¤±è´¥æ—¶æ˜¾ç¤ºemoji
                        iconImg.onerror = function() {
                            // ç§»é™¤å¤±è´¥çš„å›¾ç‰‡ï¼Œæ·»åŠ emoji
                            iconWrapper.removeChild(iconImg);
                            iconWrapper.appendChild(emojiElement);
                        };
                    } catch (e) {
                        // URLè§£æå¤±è´¥ï¼Œç›´æ¥æ˜¾ç¤ºemoji
                        iconWrapper.appendChild(emojiElement);
                    }
                }
                
                // ç½‘ç«™åç§°
                const nameSpan = document.createElement('span');
                nameSpan.className = 'text-xs font-medium text-dark';
                nameSpan.textContent = site.name;
                
                // ç»„è£…å¡ç‰‡
                siteCard.appendChild(deleteBtn);
                siteCard.appendChild(iconWrapper);
                siteCard.appendChild(nameSpan);
                container.appendChild(siteCard);
            });
        }

        function initAddSiteBtn() {
            document.getElementById('add-site-btn').addEventListener('click', () => {
                // 1. å…ˆè¯¢é—®ç½‘å€
                let url = prompt('è¯·è¾“å…¥ç½‘ç«™ç½‘å€ï¼ˆå¦‚ï¼šhttps://www.baidu.comï¼‰ï¼š');
                if (!url) return;
                
                // è‡ªåŠ¨è¡¥å…¨http
                if (!url.startsWith('http')) {
                    url = 'https://' + url;
                }
                
                // éªŒè¯URL
                try {
                    new URL(url);
                } catch (e) {
                    alert('ç½‘å€æ ¼å¼é”™è¯¯ï¼è¯·é‡æ–°è¾“å…¥æ­£ç¡®çš„ç½‘å€');
                    return;
                }
                
                // 2. è¯¢é—®ç½‘ç«™åç§°
                const name = prompt('è¯·è¾“å…¥ç½‘ç«™åç§°ï¼ˆå¦‚ï¼šç™¾åº¦ï¼‰ï¼š');
                if (!name) return;
                
                // 3. è¯¢é—®ç½‘ç«™ç±»å‹ï¼ˆæ•°å­—é€‰æ‹©ï¼‰
                const typeOptions = SITE_TYPES.map(type => `${type.id}. ${type.name} ${type.emoji}`).join('\n');
                const typeInput = prompt(`è¯·é€‰æ‹©ç½‘ç«™ç±»å‹ï¼ˆè¾“å…¥å¯¹åº”æ•°å­—ï¼‰ï¼š\n${typeOptions}`);
                
                if (!typeInput) return;
                const typeId = parseInt(typeInput);
                const selectedType = SITE_TYPES.find(type => type.id === typeId);
                
                if (!selectedType) {
                    alert('è¯·è¾“å…¥æ­£ç¡®çš„æ•°å­—é€‰æ‹©ç½‘ç«™ç±»å‹ï¼');
                    return;
                }
                
                // 4. è¯¢é—®ç½‘ç«™å›¾æ ‡é“¾æ¥
                const icon = prompt('ç•™ç©ºæˆ–è¾“å…¥ç½‘ç«™å›¾æ ‡é“¾æ¥ï¼š');
                
                // ä¿å­˜ç½‘ç«™ä¿¡æ¯
                saveCustomSite({
                    name,
                    url,
                    icon: icon || '',
                    typeId: selectedType.id,
                    typeName: selectedType.name,
                    typeEmoji: selectedType.emoji
                });
                
                alert(`${name}ï¼ˆ${selectedType.name}ï¼‰å·²æ·»åŠ åˆ°å¿«æ·å¯¼èˆªï¼`);
            });
        }
        // æ·±è‰²æ¨¡å¼
        function shouldUseDarkMode() {
            const hour = new Date().getHours();
            return hour >= 18 || hour < 6;
        }

        function toggleTheme() {
            const body = document.body;
            const themeIcon = document.querySelector('#theme-toggle .fa');
            const themeText = document.getElementById('theme-text');
            
            const isDark = body.classList.contains('dark-mode');
            
            if (isDark) {
                body.classList.remove('dark-mode');
                body.classList.add('light-mode');
                themeIcon.className = 'fa fa-moon-o text-slate-600';
                themeText.textContent = 'æ·±è‰²æ¨¡å¼';
            } else {
                body.classList.remove('light-mode');
                body.classList.add('dark-mode');
                themeIcon.className = 'fa fa-sun-o text-slate-600';
                themeText.textContent = 'æµ…è‰²æ¨¡å¼';
            }
        }

        function applyThemeByTime() {
            const body = document.body;
            const themeIcon = document.querySelector('#theme-toggle .fa');
            const themeText = document.getElementById('theme-text');
            const isDark = shouldUseDarkMode();
            
            if (isDark) {
                body.classList.remove('light-mode');
                body.classList.add('dark-mode');
                themeIcon.className = 'fa fa-sun-o text-slate-600';
                themeText.textContent = 'æµ…è‰²æ¨¡å¼';
            } else {
                body.classList.remove('dark-mode');
                body.classList.add('light-mode');
                themeIcon.className = 'fa fa-moon-o text-slate-600';
                themeText.textContent = 'æ·±è‰²æ¨¡å¼';
            }
        }

        function initTheme() {
            applyThemeByTime();
            document.getElementById('theme-toggle').addEventListener('click', toggleTheme);
            setInterval(applyThemeByTime, 60 * 60 * 1000);
        }



        // æ—¶é’Ÿå’Œæ—¥æœŸ
        function updateClock() {
            const now = new Date();
            const hours = now.getHours().toString().padStart(2, '0');
            const minutes = now.getMinutes().toString().padStart(2, '0');
            const seconds = now.getSeconds().toString().padStart(2, '0');
            
            // æ•°å­—æ—¶é’Ÿ
            document.getElementById('digital-clock').textContent = `${hours}:${minutes}:${seconds}`;
            
            // æ˜ŸæœŸ
            const weekdays = ['æ˜ŸæœŸæ—¥', 'æ˜ŸæœŸä¸€', 'æ˜ŸæœŸäºŒ', 'æ˜ŸæœŸä¸‰', 'æ˜ŸæœŸå››', 'æ˜ŸæœŸäº”', 'æ˜ŸæœŸå…­'];
            document.getElementById('week-day').textContent = weekdays[now.getDay()];
            
            // å…¬å†æ—¥æœŸ
            const year = now.getFullYear();
            const month = now.getMonth() + 1;
            const day = now.getDate();
            document.getElementById('gregorian-date').textContent = `${year}å¹´${month}æœˆ${day}æ—¥`;
            
            // å†œå†æ—¥æœŸ
            const lunar = LunarConverter.getLunarDate(now);
            document.getElementById('lunar-date').textContent = lunar.fullText;
            
            // èŠ‚æ—¥ä¿¡æ¯
            document.getElementById('festival-info').textContent = getTodayFestival(now, lunar);
            
            // é—®å€™è¯­
            const greetingEl = document.getElementById('greeting');
            let greeting = '';
            if (hours < 6) greeting = 'å‡Œæ™¨å¥½ï¼Œæ–°çš„ä¸€å¤©å¼€å§‹äº†';
            else if (hours < 9) greeting = 'æ—©ä¸Šå¥½ï¼Œå…ƒæ°”æ»¡æ»¡çš„ä¸€å¤©';
            else if (hours < 12) greeting = 'ä¸Šåˆå¥½ï¼Œå·¥ä½œå­¦ä¹ é¡ºåˆ©';
            else if (hours < 14) greeting = 'ä¸­åˆå¥½ï¼Œè®°å¾—å¥½å¥½åƒé¥­';
            else if (hours < 18) greeting = 'ä¸‹åˆå¥½ï¼Œç»§ç»­åŠ æ²¹';
            else if (hours < 22) greeting = 'æ™šä¸Šå¥½ï¼Œæ”¾æ¾ä¸€ä¸‹å§';
            else greeting = 'å¤œæ·±äº†ï¼Œæ—©ç‚¹ä¼‘æ¯å“¦';
            greetingEl.textContent = greeting;
            
            // æ›´æ–°å€’è®¡æ—¶
            updateCountdownDisplay();
        }

                // ========== æ–°å¢ï¼šæœç´¢åŠŸèƒ½åˆå§‹åŒ–ï¼ˆå¿…åº”+ç™¾åº¦+è°·æ­Œï¼‰ ==========
        function initSearch() {
            const searchBtn = document.getElementById('search-btn');
            const searchInput = document.getElementById('search-input');
            const searchEngine = document.getElementById('search-engine');

            // æœç´¢æ ¸å¿ƒé€»è¾‘
            function handleSearch() {
                const keyword = searchInput.value.trim();
                if (!keyword) {
                    alert('è¯·è¾“å…¥æœç´¢å†…å®¹ï¼');
                    return;
                }

                // æ ¹æ®é€‰æ‹©çš„å¼•æ“æ‹¼æ¥æœç´¢URL
                let searchUrl = '';
                const engine = searchEngine.value;
                switch (engine) {
                    case 'baidu':
                        searchUrl = `https://www.baidu.com/s?wd=${encodeURIComponent(keyword)}`;
                        break;
                    case 'google':
                        searchUrl = `https://www.google.com/search?q=${encodeURIComponent(keyword)}`;
                        break;
                    case 'bing': // å¿…åº”æœç´¢é€»è¾‘
                        searchUrl = `https://cn.bing.com/search?q=${encodeURIComponent(keyword)}`;
                        break;
                    default:
                        searchUrl = `https://www.baidu.com/s?wd=${encodeURIComponent(keyword)}`;
                }

                // æ‰“å¼€æ–°æ ‡ç­¾é¡µæœç´¢
                window.open(searchUrl, '_blank');
            }

            // ç»‘å®šæœç´¢æŒ‰é’®ç‚¹å‡»äº‹ä»¶
            searchBtn.addEventListener('click', handleSearch);

            // ç»‘å®šå›è½¦é”®æœç´¢
            searchInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    handleSearch();
                }
            });
        }

        // åˆå§‹åŒ–æ‰€æœ‰åŠŸèƒ½
        window.addEventListener('DOMContentLoaded', () => {
            // åˆå§‹åŒ–æ—¶é’Ÿ
            updateClock();
            setInterval(updateClock, 1000);
            
            // åˆå§‹åŒ–åŠŸèƒ½æ¨¡å—
            initAddBirthdayBtn();
            initAddCustomDateBtn();
            initAddCountdownBtn();
            initConverter();
            initCalculator();
            initNotes();
            initAddSiteBtn();
            initTheme();
            initSearch();
            
            // æ¸²æŸ“è‡ªå®šä¹‰ç½‘ç«™
            renderCustomSites();
        });
    </script>
</body>
</html>